<th:block xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.thymeleaf.org/extras/spring-security" th:fragment="navbar">
    <nav class="navbar">
        <div class="nav-container">
            <div class="nav-logo">
                <a th:href="@{/home}">
                    <span class="logo-text">VERDE</span>
                    <span class="logo-highlight">VIVE</span>
                </a>
            </div>

            <ul class="nav-menu" th:unless="${#authorization.expression('isAuthenticated()')}">
                <li class="nav-item"><a th:href="@{/home}" class="nav-link">Home</a></li>
                <li class="nav-item"><a href="#" class="nav-link">About</a></li>
                <li class="nav-item"><a href="#" class="nav-link">Service</a></li>
                <li class="nav-item"><a href="#" class="nav-link">Price</a></li>
                <li class="nav-item dropdown">
                    <a href="#" class="nav-link">Pages ?</a>
                    <ul class="dropdown-menu">
                        <li><a href="#">Galeria</a></li>
                        <li><a href="#">Blog</a></li>
                        <li><a href="#">Equipo</a></li>
                        <li><a href="#">Testimonios</a></li>
                    </ul>
                </li>
                <li class="nav-item"><a href="#" class="nav-link">Contact</a></li>
            </ul>

            <ul class="nav-menu" th:if="${#authorization.expression('isAuthenticated()')}">
                <li class="nav-item"><a th:href="@{/home}" class="nav-link">Inicio</a></li>
                <li class="nav-item" th:if="${#authorization.expression('hasRole(''ADMIN'')')}">
                    <a th:href="@{/admin/panel}" class="nav-link">Panel Admin</a>
                </li>
                <li class="nav-item" th:if="${#authorization.expression('hasRole(''USER'')')}">
                    <a th:href="@{/user/panel}" class="nav-link">Mi Panel</a>
                </li>
                <li class="nav-item" th:if="${#authorization.expression('hasRole(''ADMIN'')')}">
                    <a th:href="@{/actividades}" class="nav-link">Actividades</a>
                </li>
                <li class="nav-item">
                    <a th:href="@{/secciones}" class="nav-link">Secciones</a>
                </li>
                <li class="nav-item">
                    <a th:href="@{/acciones}" class="nav-link">Acciones</a>
                </li>
                <li class="nav-item" th:if="${#authorization.expression('hasRole(''USER'')')}">
                    <a th:href="@{/actividades}" class="nav-link">Actividades</a>
                </li>
            </ul>

            <div class="nav-buttons">
                <div th:unless="${#authorization.expression('isAuthenticated()')}">
                    <a th:href="@{/login}" class="btn btn-login">Iniciar sesion</a>
                    <a th:href="@{/registro}" class="btn btn-quote">Registrarse</a>
                </div>

                <div th:if="${#authorization.expression('isAuthenticated()')}">
                    <form th:action="@{/logout}" method="post" style="display: inline;" class="logout-form">
                        <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />
                        <button type="submit" class="btn btn-logout">Cerrar sesion</button>
                    </form>
                </div>
            </div>

            <div class="hamburger">
                <span class="bar"></span>
                <span class="bar"></span>
                <span class="bar"></span>
            </div>
        </div>
    </nav>

    <script th:src="@{/js/main.js}"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function () {
            document.querySelectorAll('.logout-form').forEach(function (form) {
                form.addEventListener('submit', function (event) {
                    event.preventDefault();
                    Swal.fire({
                        title: 'Cerrar sesion?',
                        text: 'Tu sesion actual se cerrara.',
                        icon: 'warning',
                        showCancelButton: true,
                        confirmButtonText: 'Si, cerrar',
                        cancelButtonText: 'Cancelar',
                        confirmButtonColor: '#dc3545',
                        cancelButtonColor: '#6c757d'
                    }).then(function (result) {
                        if (result.isConfirmed) {
                            form.submit();
                        } else {
                            Swal.fire({
                                icon: 'info',
                                title: 'Operacion cancelada',
                                text: 'La sesion sigue activa.',
                                confirmButtonColor: '#0d6efd'
                            });
                        }
                    });
                });
            });
        });
    </script>
</th:block>
